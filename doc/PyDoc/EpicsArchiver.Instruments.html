
<!doctype html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><title>Python: class Instruments</title>
</head><body bgcolor="#f0f0f8">
<p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#ffc8d8">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#000000" face="helvetica, arial"><strong>EpicsArchiver.Instruments</strong> = <a name="EpicsArchiver.Instruments">class Instruments</a>(<a href="EpicsArchiver.MasterDB.html#MasterDB">EpicsArchiver.MasterDB.MasterDB</a>)</font></td></tr>
    
<tr bgcolor="#ffc8d8"><td rowspan=2><tt>&nbsp;&nbsp;&nbsp;</tt></td>
<td colspan=2><tt>interface&nbsp;to&nbsp;Instruments<br>&nbsp;</tt></td></tr>
<tr><td>&nbsp;</td>
<td width="100%">Methods defined here:<br>
<dl><dt><a name="Instruments-__init__"><strong>__init__</strong></a>(self, dbconn<font color="#909090">=None</font>, **kw)</dt></dl>

<dl><dt><a name="Instruments-create_instrument"><strong>create_instrument</strong></a>(self, name<font color="#909090">=None</font>, station<font color="#909090">=None</font>, notes<font color="#909090">=''</font>)</dt></dl>

<dl><dt><a name="Instruments-create_station"><strong>create_station</strong></a>(self, name<font color="#909090">=None</font>, notes<font color="#909090">=''</font>)</dt><dd><tt>create&nbsp;a&nbsp;station&nbsp;by&nbsp;name</tt></dd></dl>

<dl><dt><a name="Instruments-delete_position"><strong>delete_position</strong></a>(self, inst_id<font color="#909090">=None</font>, name<font color="#909090">=None</font>)</dt><dd><tt>delete&nbsp;named&nbsp;positions&nbsp;for&nbsp;an&nbsp;instrument&nbsp;id</tt></dd></dl>

<dl><dt><a name="Instruments-get_instrument_id"><strong>get_instrument_id</strong></a>(self, name<font color="#909090">=None</font>, station<font color="#909090">=None</font>)</dt><dd><tt>return&nbsp;list&nbsp;of&nbsp;instrument&nbsp;ids&nbsp;from&nbsp;name&nbsp;--&nbsp;note<br>
that&nbsp;there&nbsp;may&nbsp;be&nbsp;more&nbsp;than&nbsp;one&nbsp;instrument&nbsp;with&nbsp;the<br>
same&nbsp;name!!&nbsp;&nbsp;Use&nbsp;optional&nbsp;station&nbsp;argument&nbsp;to<br>
limit&nbsp;instrument&nbsp;choices</tt></dd></dl>

<dl><dt><a name="Instruments-get_instrument_names_from_id"><strong>get_instrument_names_from_id</strong></a>(self, id<font color="#909090">=0</font>)</dt></dl>

<dl><dt><a name="Instruments-get_instrument_pvs"><strong>get_instrument_pvs</strong></a>(self, name<font color="#909090">=None</font>, station<font color="#909090">=None</font>, **kw)</dt></dl>

<dl><dt><a name="Instruments-get_instrument_values"><strong>get_instrument_values</strong></a>(self, inst_id<font color="#909090">=None</font>, position<font color="#909090">=None</font>, ts<font color="#909090">=None</font>)</dt><dd><tt>given&nbsp;an&nbsp;instrument&nbsp;id&nbsp;and&nbsp;either&nbsp;a&nbsp;position&nbsp;name&nbsp;or&nbsp;timestamp<br>
return&nbsp;a&nbsp;list&nbsp;of&nbsp;(pvname,values)&nbsp;tuples&nbsp;for&nbsp;all&nbsp;PVs&nbsp;in&nbsp;that&nbsp;instrument.<br>
returns&nbsp;list_of_pv_values<br>
where&nbsp;list_of_pv_values&nbsp;is&nbsp;a&nbsp;list&nbsp;of&nbsp;(pvname,values)<br>
&nbsp;<br>
Note&nbsp;that&nbsp;the&nbsp;values&nbsp;returned&nbsp;may&nbsp;be&nbsp;None,&nbsp;meaning&nbsp;'unknown'</tt></dd></dl>

<dl><dt><a name="Instruments-get_instruments"><strong>get_instruments</strong></a>(self, name<font color="#909090">=None</font>, station<font color="#909090">=None</font>)</dt></dl>

<dl><dt><a name="Instruments-get_positions"><strong>get_positions</strong></a>(self, inst_id<font color="#909090">=None</font>, inst<font color="#909090">=None</font>, station<font color="#909090">=None</font>, name<font color="#909090">=None</font>, get_hidden<font color="#909090">=False</font>)</dt><dd><tt>return&nbsp;a&nbsp;list&nbsp;of&nbsp;(id,name,ts)&nbsp;for&nbsp;instrument_positions<br>
(that&nbsp;is&nbsp;the&nbsp;position&nbsp;id,&nbsp;position&nbsp;name,&nbsp;timestamp&nbsp;for&nbsp;position)<br>
given&nbsp;an&nbsp;instrument&nbsp;name,&nbsp;and&nbsp;optionally&nbsp;a&nbsp;station&nbsp;name,&nbsp;and<br>
optionally&nbsp;a&nbsp;position&nbsp;name</tt></dd></dl>

<dl><dt><a name="Instruments-get_station_id"><strong>get_station_id</strong></a>(self, name<font color="#909090">=None</font>)</dt><dd><tt>return&nbsp;station&nbsp;id&nbsp;from&nbsp;station&nbsp;name</tt></dd></dl>

<dl><dt><a name="Instruments-hide_position"><strong>hide_position</strong></a>(self, inst_id<font color="#909090">=None</font>, name<font color="#909090">=None</font>, hide<font color="#909090">=True</font>)</dt><dd><tt>hide&nbsp;or&nbsp;unhide&nbsp;named&nbsp;positions&nbsp;for&nbsp;an&nbsp;instrument&nbsp;id</tt></dd></dl>

<dl><dt><a name="Instruments-list_instruments"><strong>list_instruments</strong></a>(self, station<font color="#909090">=None</font>)</dt><dd><tt>return&nbsp;a&nbsp;list&nbsp;of&nbsp;dictionaries&nbsp;for&nbsp;all&nbsp;defined&nbsp;instruments<br>
providing&nbsp;an&nbsp;optional&nbsp;station&nbsp;name&nbsp;will&nbsp;return&nbsp;all&nbsp;defined<br>
instruments&nbsp;in&nbsp;that&nbsp;station</tt></dd></dl>

<dl><dt><a name="Instruments-list_stations"><strong>list_stations</strong></a>(self)</dt><dd><tt>return&nbsp;a&nbsp;list&nbsp;of&nbsp;dictionaries&nbsp;for&nbsp;current&nbsp;stations</tt></dd></dl>

<dl><dt><a name="Instruments-remove_instrument_pvs"><strong>remove_instrument_pvs</strong></a>(self, pvlist, name<font color="#909090">=None</font>, station<font color="#909090">=None</font>, notes<font color="#909090">=''</font>)</dt></dl>

<dl><dt><a name="Instruments-save_instrument_position"><strong>save_instrument_position</strong></a>(self, inst_id<font color="#909090">=None</font>, name<font color="#909090">=None</font>, ts<font color="#909090">=None</font>, inst<font color="#909090">=None</font>, station<font color="#909090">=None</font>)</dt></dl>

<dl><dt><a name="Instruments-set_instrument_pvs"><strong>set_instrument_pvs</strong></a>(self, pvlist, name<font color="#909090">=None</font>, station<font color="#909090">=None</font>, notes<font color="#909090">=''</font>)</dt></dl>

<hr>
Methods inherited from <a href="EpicsArchiver.MasterDB.html#MasterDB">EpicsArchiver.MasterDB.MasterDB</a>:<br>
<dl><dt><a name="Instruments-add_alert"><strong>add_alert</strong></a>(self, pvname<font color="#909090">=None</font>, name<font color="#909090">=None</font>, mailto<font color="#909090">=None</font>, mailmsg<font color="#909090">=None</font>, timeout<font color="#909090">=30</font>, compare<font color="#909090">='ne'</font>, trippoint<font color="#909090">=None</font>, **kw)</dt><dd><tt>add&nbsp;&nbsp;a&nbsp;new&nbsp;alert</tt></dd></dl>

<dl><dt><a name="Instruments-add_pv"><strong>add_pv</strong></a>(self, pvname)</dt><dd><tt>adds&nbsp;a&nbsp;PV&nbsp;to&nbsp;the&nbsp;cache:&nbsp;actually&nbsp;requests&nbsp;the&nbsp;addition,&nbsp;which&nbsp;will<br>
be&nbsp;handled&nbsp;by&nbsp;the&nbsp;next&nbsp;process_requests&nbsp;in&nbsp;mainloop().<br>
&nbsp;<br>
Here,&nbsp;we&nbsp;check&nbsp;for&nbsp;'Motor'&nbsp;PV&nbsp;typs&nbsp;and&nbsp;make&nbsp;sure&nbsp;all&nbsp;motor&nbsp;fields&nbsp;are<br>
requested&nbsp;together,&nbsp;and&nbsp;that&nbsp;the&nbsp;motor&nbsp;fields&nbsp;are&nbsp;'related'&nbsp;by&nbsp;assigning<br>
a&nbsp;pair_score&nbsp;=&nbsp;10.</tt></dd></dl>

<dl><dt><a name="Instruments-arch_nchanged"><strong>arch_nchanged</strong></a>(self, minutes<font color="#909090">=10</font>)</dt><dd><tt>return&nbsp;the&nbsp;number&nbsp;of&nbsp;values&nbsp;archived&nbsp;in&nbsp;the&nbsp;past&nbsp;minutes.</tt></dd></dl>

<dl><dt><a name="Instruments-arch_report"><strong>arch_report</strong></a>(self, minutes<font color="#909090">=10</font>)</dt><dd><tt>return&nbsp;a&nbsp;report&nbsp;(list&nbsp;of&nbsp;text&nbsp;lines)&nbsp;for&nbsp;archiving&nbsp;process,<br>
giving&nbsp;the&nbsp;number&nbsp;of&nbsp;values&nbsp;archived&nbsp;in&nbsp;the&nbsp;past&nbsp;minutes.</tt></dd></dl>

<dl><dt><a name="Instruments-cache_report"><strong>cache_report</strong></a>(self, brief<font color="#909090">=False</font>, dt<font color="#909090">=60</font>)</dt><dd><tt>return&nbsp;a&nbsp;report&nbsp;(list&nbsp;of&nbsp;text&nbsp;lines)&nbsp;for&nbsp;caching&nbsp;process,<br>
giving&nbsp;number&nbsp;of&nbsp;values&nbsp;cached&nbsp;in&nbsp;the&nbsp;past&nbsp;dt&nbsp;seconds.<br>
Use&nbsp;'brief=False'&nbsp;to&nbsp;show&nbsp;which&nbsp;PVs&nbsp;have&nbsp;been&nbsp;cached.</tt></dd></dl>

<dl><dt><a name="Instruments-check_alert"><strong>check_alert</strong></a>(self, id, value, sendmail<font color="#909090">=False</font>)</dt><dd><tt>check&nbsp;alert&nbsp;status,&nbsp;sending&nbsp;mail&nbsp;if&nbsp;necessary.<br>
returns&nbsp;two&nbsp;boolean&nbsp;values:&nbsp;(Value_OK,&nbsp;Mail_Was_Sent)</tt></dd></dl>

<dl><dt><a name="Instruments-close"><strong>close</strong></a>(self)</dt><dd><tt>close&nbsp;db&nbsp;connection</tt></dd></dl>

<dl><dt><a name="Instruments-dbs_for_time"><strong>dbs_for_time</strong></a>(self, t0<font color="#909090">=86400.0</font>, t1<font color="#909090">=2147483647.0</font>)</dt><dd><tt>return&nbsp;list&nbsp;of&nbsp;databases&nbsp;with&nbsp;data&nbsp;in&nbsp;the&nbsp;given&nbsp;time&nbsp;range</tt></dd></dl>

<dl><dt><a name="Instruments-drop_pv"><strong>drop_pv</strong></a>(self, pvname)</dt><dd><tt>drop&nbsp;a&nbsp;PV&nbsp;from&nbsp;the&nbsp;caching&nbsp;process&nbsp;--&nbsp;really&nbsp;this&nbsp;'suspends&nbsp;updates'<br>
will&nbsp;take&nbsp;effect&nbsp;once&nbsp;a&nbsp;'process_requests'&nbsp;is&nbsp;executed.</tt></dd></dl>

<dl><dt><a name="Instruments-get_alert_with_id"><strong>get_alert_with_id</strong></a>(self, id)</dt><dd><tt>return&nbsp;a&nbsp;list&nbsp;of&nbsp;alerts&nbsp;for&nbsp;a&nbsp;pvname</tt></dd></dl>

<dl><dt><a name="Instruments-get_alerts"><strong>get_alerts</strong></a>(self, pvname<font color="#909090">=None</font>, name<font color="#909090">=None</font>)</dt><dd><tt>return&nbsp;a&nbsp;list&nbsp;of&nbsp;alerts&nbsp;for&nbsp;a&nbsp;pvname</tt></dd></dl>

<dl><dt><a name="Instruments-get_arch_pid"><strong>get_arch_pid</strong></a>(self)</dt><dd><tt>get&nbsp;pid&nbsp;of&nbsp;archiving&nbsp;process</tt></dd></dl>

<dl><dt><a name="Instruments-get_arch_status"><strong>get_arch_status</strong></a>(self)</dt><dd><tt>get&nbsp;status&nbsp;of&nbsp;archiving&nbsp;process</tt></dd></dl>

<dl><dt><a name="Instruments-get_cache_pid"><strong>get_cache_pid</strong></a>(self)</dt><dd><tt>get&nbsp;pid&nbsp;of&nbsp;caching&nbsp;process</tt></dd></dl>

<dl><dt><a name="Instruments-get_cache_status"><strong>get_cache_status</strong></a>(self)</dt><dd><tt>get&nbsp;status&nbsp;of&nbsp;caching&nbsp;process</tt></dd></dl>

<dl><dt><a name="Instruments-get_instruments_with_pv"><strong>get_instruments_with_pv</strong></a>(self, pv)</dt><dd><tt>return&nbsp;a&nbsp;list&nbsp;of&nbsp;(instrument&nbsp;ids,&nbsp;inst&nbsp;name,&nbsp;station&nbsp;name)&nbsp;for<br>
instruments&nbsp;which&nbsp;&nbsp;contain&nbsp;a&nbsp;named&nbsp;pv</tt></dd></dl>

<dl><dt><a name="Instruments-get_pair_score"><strong>get_pair_score</strong></a>(self, pv1, pv2)</dt><dd><tt>set&nbsp;pair&nbsp;score&nbsp;for&nbsp;2&nbsp;pvs</tt></dd></dl>

<dl><dt><a name="Instruments-get_pvnames"><strong>get_pvnames</strong></a>(self)</dt><dd><tt>generate&nbsp;self.<strong>pvnames</strong>:&nbsp;a&nbsp;list&nbsp;of&nbsp;pvnames&nbsp;in&nbsp;the&nbsp;cache</tt></dd></dl>

<dl><dt><a name="Instruments-get_recent"><strong>get_recent</strong></a>(self, dt<font color="#909090">=60</font>)</dt><dd><tt>get&nbsp;recent&nbsp;additions&nbsp;to&nbsp;the&nbsp;cache,&nbsp;those<br>
inserted&nbsp;in&nbsp;the&nbsp;last&nbsp;&nbsp;dt&nbsp;&nbsp;seconds.</tt></dd></dl>

<dl><dt><a name="Instruments-get_related_pvs"><strong>get_related_pvs</strong></a>(self, pv, minscore<font color="#909090">=1</font>)</dt><dd><tt>return&nbsp;a&nbsp;list&nbsp;of&nbsp;related&nbsp;pvs&nbsp;to&nbsp;the&nbsp;provided&nbsp;pv<br>
with&nbsp;a&nbsp;minumum&nbsp;pair&nbsp;score</tt></dd></dl>

<dl><dt><a name="Instruments-increment_pair_score"><strong>increment_pair_score</strong></a>(self, pv1, pv2)</dt><dd><tt>increase&nbsp;by&nbsp;1&nbsp;the&nbsp;pair&nbsp;score&nbsp;for&nbsp;two&nbsp;pvs</tt></dd></dl>

<dl><dt><a name="Instruments-remove_alert"><strong>remove_alert</strong></a>(self, id<font color="#909090">=None</font>)</dt><dd><tt>remove&nbsp;an&nbsp;alert</tt></dd></dl>

<dl><dt><a name="Instruments-request_pv_cache"><strong>request_pv_cache</strong></a>(self, pvname)</dt><dd><tt>request&nbsp;a&nbsp;PV&nbsp;to&nbsp;be&nbsp;included&nbsp;in&nbsp;caching.<br>
will&nbsp;take&nbsp;effect&nbsp;once&nbsp;a&nbsp;'process_requests'&nbsp;is&nbsp;executed.</tt></dd></dl>

<dl><dt><a name="Instruments-runs_report"><strong>runs_report</strong></a>(self)</dt><dd><tt>return&nbsp;a&nbsp;report&nbsp;(list&nbsp;of&nbsp;text&nbsp;lines)&nbsp;for&nbsp;the&nbsp;archiving&nbsp;runs<br>
showing&nbsp;the&nbsp;time&nbsp;ranges&nbsp;for&nbsp;the&nbsp;(at&nbsp;most)&nbsp;10&nbsp;most&nbsp;recent&nbsp;runs.</tt></dd></dl>

<dl><dt><a name="Instruments-save_db"><strong>save_db</strong></a>(self, dbname<font color="#909090">=None</font>)</dt></dl>

<dl><dt><a name="Instruments-sendmail"><strong>sendmail</strong></a>(self, alarm, value)</dt><dd><tt>send&nbsp;an&nbsp;alert&nbsp;email&nbsp;from&nbsp;an&nbsp;alarm&nbsp;dict&nbsp;holding<br>
the&nbsp;appropriate&nbsp;row&nbsp;of&nbsp;the&nbsp;alert&nbsp;table.</tt></dd></dl>

<dl><dt><a name="Instruments-set_allpairs"><strong>set_allpairs</strong></a>(self, pvlist, score<font color="#909090">=10</font>)</dt><dd><tt>for&nbsp;a&nbsp;list/tuple&nbsp;of&nbsp;pvs,&nbsp;set&nbsp;all&nbsp;pair&nbsp;scores<br>
to&nbsp;be&nbsp;at&nbsp;least&nbsp;the&nbsp;provided&nbsp;score</tt></dd></dl>

<dl><dt><a name="Instruments-set_arch_pid"><strong>set_arch_pid</strong></a>(self, pid)</dt><dd><tt>set&nbsp;pid&nbsp;of&nbsp;archiving&nbsp;process</tt></dd></dl>

<dl><dt><a name="Instruments-set_arch_status"><strong>set_arch_status</strong></a>(self, status)</dt><dd><tt>set&nbsp;status&nbsp;of&nbsp;archiving&nbsp;process</tt></dd></dl>

<dl><dt><a name="Instruments-set_cache_pid"><strong>set_cache_pid</strong></a>(self, pid)</dt><dd><tt>set&nbsp;pid&nbsp;of&nbsp;caching&nbsp;process</tt></dd></dl>

<dl><dt><a name="Instruments-set_cache_status"><strong>set_cache_status</strong></a>(self, status)</dt><dd><tt>set&nbsp;status&nbsp;of&nbsp;caching&nbsp;process</tt></dd></dl>

<dl><dt><a name="Instruments-set_pair_score"><strong>set_pair_score</strong></a>(self, pv1, pv2, score<font color="#909090">=None</font>)</dt><dd><tt>set&nbsp;pair&nbsp;score&nbsp;for&nbsp;2&nbsp;pvs</tt></dd></dl>

<dl><dt><a name="Instruments-update_alert"><strong>update_alert</strong></a>(self, id<font color="#909090">=None</font>, **kw)</dt><dd><tt>modify&nbsp;an&nbsp;existing&nbsp;alert,&nbsp;index&nbsp;with&nbsp;id,&nbsp;and&nbsp;passing&nbsp;in<br>
keyword&nbsp;args&nbsp;for&nbsp;('pvname','name','mailto','mailmsg',<br>
'trippoint','compare','status','active')</tt></dd></dl>

<dl><dt><a name="Instruments-use_current_archive"><strong>use_current_archive</strong></a>(self)</dt><dd><tt>point&nbsp;db&nbsp;cursor&nbsp;to&nbsp;use&nbsp;current&nbsp;archive&nbsp;database</tt></dd></dl>

<dl><dt><a name="Instruments-use_master"><strong>use_master</strong></a>(self)</dt><dd><tt>point&nbsp;db&nbsp;cursor&nbsp;to&nbsp;use&nbsp;master&nbsp;database</tt></dd></dl>

<hr>
Data and other attributes inherited from <a href="EpicsArchiver.MasterDB.html#MasterDB">EpicsArchiver.MasterDB.MasterDB</a>:<br>
<dl><dt><strong>def_alert_msg</strong> = 'Hello,<font color="#c040c0">\n</font>  An alarm labeled  %LABEL%<font color="#c040c0">\n</font>  was detecte... This is %COMP% the trip point value of %TRIP%<font color="#c040c0">\n</font>  '</dl>

<dl><dt><strong>ops</strong> = {'eq': '__eq__', 'ge': '__ge__', 'gt': '__gt__', 'le': '__le__', 'lt': '__lt__', 'ne': '__ne__'}</dl>

<dl><dt><strong>opstrings</strong> = ('not equal to', 'equal to', 'less than or equal to', 'less than', 'greater than or equal to', 'greater than')</dl>

<dl><dt><strong>optokens</strong> = ('ne', 'eq', 'le', 'lt', 'ge', 'gt')</dl>

<dl><dt><strong>runs_line</strong> = '|-------------------|---------------------------|----------------|'</dl>

<dl><dt><strong>runs_title</strong> = '|  database         |       date range          | duration (days)|'</dl>

</td></tr></table>
</body></html>